<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<title>
			SprintBacklogUITest
		</title>
		<script src="../jquery.min.js" type="text/javascript"></script>
		<link rel="stylesheet" href="qunit.css" type="text/css" media="screen" />
		<script type="text/javascript" src="qunit.js"></script>
		<script type="text/javascript" src="../sprint_backlog_ui.js"></script>
		<script type="text/javascript" src="fixtures.js"></script>
		<script type="text/javascript">
$(document).ready(function(){

	var sbui
	module("SprintBacklogUI", {
		setup: function() {
			var sprint_id = 2
			sbui = new SprintBacklogUI(product_backlog, project_backlog, sprint_id)
		}
	});

	test("instantiate SprintBacklogUI", function() {
		ok(sbui != null)
	});
	
	test("render product backlog", function() {
		sbui.render_product_backlog('#product_backlog_div')
		
		// options
		var options = get_options()
		equal(options.length, 36)
		equal(options[0].text, '(2) Preencher Dados Gerais do Fornecedor')
		equal(options[1].text, '(2) Buscar Fornecedor')
		equal(options[2].text, '(5) Cadastrar Produtos do Fornecedor')
		equal(options[3].text, '(2) Visualizar Perfil da Universidade')
		equal(options[35].text, '(3) Moderar F\u00f3rum')
		
		// optgroups
		var groups = get_groups()
		equal(groups.length, 11)
		equal(groups[0].label, 'Fornecedores')
		equal(groups[1].label, 'Universidades')
		equal(groups[2].label, 'Portal')
		equal(groups[10].label, 'F\u00f3rum de Discuss\u00e3o')
	});
	
	test("render sprint backlog", function() {
		sbui.render_sprint_backlog("#sprint_backlog_div")
		
		var items = get_items()
		equal(items.length, 4)
		equal(items[0].innerHTML, 'Buscar Empresa de Arquitetura')
		equal(items[1].innerHTML, 'Preencher Dados Gerais da Empresa')
		equal(items[2].innerHTML, 'Construir Show Room de Projetos da Empresa')
		equal(items[3].innerHTML, 'Visualizar Perfil do Fornecedor')
	});
	
	test("add", function() {
		$('#' + sbui.select_tag_id).val(699408949)
		sbui.add("#product_backlog_div", "#sprint_backlog_div")
	
		var options = get_options()
		equal(options.length, 35)
		equal(options[0].text, '(2) Buscar Fornecedor')
	
		var items = get_items()
		equal(items.length, 5)
		equal(items[4].innerHTML, 'Preencher Dados Gerais do Fornecedor')
	
	});
	
	test("remove", function() {
		sbui.remove(470307930, "#product_backlog_div", "#sprint_backlog_div")		
		
		var options = get_options()
		equal(options.length, 36)
		equal(options[0].text, '(3) Buscar Empresa de Arquitetura')
	
		var items = get_items()
		equal(items.length, 4)
		equal(items[0].innerHTML, 'Preencher Dados Gerais da Empresa')		
	});
	
	test("story_points", function() {
		sbui.render_product_backlog('#product_backlog_div')
		sbui.render_sprint_backlog("#sprint_backlog_div")
		equal(sbui.story_points(), 15)
	});

	test("backlog_points", function() {
		sbui.render_product_backlog('#product_backlog_div')
		sbui.render_sprint_backlog("#sprint_backlog_div")
		equal(sbui.backlog_points(), 85)
	});
	
	// obtains select options	
	function get_options() {
		var el = $("#" + sbui.select_tag_id)
		ok(el != null)
		return el[0].options
	}
	
	// obtains select optgroups
	function get_groups() {
		return $("optgroup")
	}
	
	// obtains sprint backlog items
	function get_items() {
		return $('#sprint_backlog_div div span.item_not_done')
	}

});
		</script>
	</head>
	<body>
		<h1 id="qunit-header">
			SprintBacklogUI Test
		</h1>
		<h2 id="qunit-banner"></h2>
		<div id="qunit-testrunner-toolbar"></div>
		<h2 id="qunit-userAgent"></h2>
		<ol id="qunit-tests"></ol>
		<div id="qunit-fixture">
			test markup, will be hidden
		</div>
		<div id="product_backlog_div"></div>
		<div id="sprint_backlog_div"></div>
	</body>
</html>
